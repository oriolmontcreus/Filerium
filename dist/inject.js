(()=>{"use strict";const e=e=>`\n    background-color: ${e};\n    border: none;\n    border-radius: 12px;\n    color: white;\n    padding: 10px 20px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 16px;\n    margin: 4px 2px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n`,t="#5688C7";var n=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))};const i=console.log.bind(console),o=console.error.bind(console);i("inject.js loaded");const r=(e,t)=>{const n=document.createElement(e);return n.style.cssText="\n    width: 100%;\n    height: auto;\n    max-width: 70%;\n    max-height: 55vh;\n    display: block;\n    margin: auto;\n    object-fit: contain;\n","img"===e?(n.src=t,n.style.maxWidth="100%",n.style.height="auto"):n.innerHTML=t,n};n(void 0,void 0,void 0,(function*(){if(window.fileInputInterceptorActive)return i("File input interceptor already active");window.fileInputInterceptorActive=!0,i("Initializing file input interceptor");const{primaryColor:a,secondaryColor:s,actionColor:l}=yield new Promise((e=>{var n;if(!(null===(n=null===chrome||void 0===chrome?void 0:chrome.runtime)||void 0===n?void 0:n.sendMessage))return o("chrome.runtime.sendMessage is not available"),e({primaryColor:t,secondaryColor:t,actionColor:t});chrome.runtime.sendMessage({type:"GET_USER_COLORS"},(n=>{if(chrome.runtime.lastError)return o("Error retrieving user colors:",chrome.runtime.lastError),e({primaryColor:t,secondaryColor:t,actionColor:t});e({primaryColor:n.primaryColor,secondaryColor:n.secondaryColor,actionColor:n.actionColor})}))}));let c=null;const d=(t,n,i)=>{const o=document.createElement("button");return o.style.cssText=e(i),o.innerHTML=t,o.onclick=n,o.onmouseover=()=>o.style.cssText+="\n    filter: brightness(0.8);\n    transform: scale(1.05);\n",o.onmouseout=()=>o.style.cssText=e(i),o},p=e=>{const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),o=new Uint8Array(i);for(let e=0;e<t.length;e++)o[e]=t.charCodeAt(e);return new Blob([i],{type:n})},m=e=>({"image/png":"png","image/jpeg":"jpg","image/gif":"gif","text/plain":"txt","text/html":"html","text/csv":"csv","application/json":"json","image/svg+xml":"svg"}[e]||"bin");document.addEventListener("click",(e=>{if(!window.fileInputInterceptorActive)return;const t=e.target;var o,u,g,v;t instanceof HTMLInputElement&&"file"===t.type&&(e.preventDefault(),e.stopPropagation(),o=t,u=a,g=s,v=l,n(void 0,void 0,void 0,(function*(){const{success:e,clipboardData:t,message:a}=yield n(void 0,void 0,void 0,(function*(){try{const e=yield navigator.clipboard.read();i("clipboardItems:",e);for(const t of e)for(const e of t.types){const n=yield t.getType(e),i=new FileReader,o=()=>new Promise((t=>{i.onloadend=()=>t(i.result),e.startsWith("image/")?i.readAsDataURL(n):i.readAsText(n)})),r=yield o();return{success:!0,clipboardData:{fileDataUrl:e.startsWith("image/svg+xml")||"text/plain"===e&&r.startsWith("<svg")?`data:image/svg+xml;base64,${btoa(r)}`:r,mimeType:e.startsWith("image/svg+xml")||"text/plain"===e&&r.startsWith("<svg")?"image/svg+xml":e,displayData:r}}}return{success:!0,message:"No supported data found in clipboard"}}catch(e){return e("Error reading clipboard:",e),{success:!1,message:e.message}}}));if(!e||!t)return i(a||"No valid data found in clipboard, proceeding with default file input action."),window.fileInputInterceptorActive=!1,o.click(),void(window.fileInputInterceptorActive=!0);c=t;const s=document.createElement("div");s.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.5);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 9999;\n    user-select: none;\n";const l=document.createElement("div");l.style.cssText=(e=>`\n    background-color: ${e};\n    padding: 20px;\n    text-align: center;\n    max-width: 80%;\n    max-height: 80%;\n    overflow: auto;\n    border-radius: 12px;\n    border: 3px solid #333;\n    color: #fff;\n`)(u),s.onclick=l.onclick=()=>s.remove();const h=d('\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle;">\n    <circle cx="17" cy="17" r="3"/>\n    <path d="M10.7 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v4.1"/>\n    <path d="m21 21-1.5-1.5"/>\n</svg>\n',(()=>{window.fileInputInterceptorActive=!1,o.click(),window.fileInputInterceptorActive=!0}),v),f=d('\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle;">\n    <path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/>\n    <path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/>\n    <path d="m17 10 4 4-4 4"/>\n</svg>\n',(()=>{var e;let t=c.mimeType;c.fileDataUrl.startsWith("data:image/")&&(t=(null===(e=c.fileDataUrl.match(/data:([^;,]+)/))||void 0===e?void 0:e[1])||t);const n="image/svg+xml"===t||t.startsWith("text/")?new Blob([c.displayData],{type:t}):p(c.fileDataUrl),i=new File([n],`pasted_file.${m(t)}`,{type:t}),r=new DataTransfer;r.items.add(i),o.files=r.files,o.dispatchEvent(new Event("change",{bubbles:!0}))}),v),y=document.createElement("div");y.style.cssText=(e=>`\n    max-width: 100%;\n    max-height: 90vh;\n    background-color: ${e};\n    color: #fff;\n    padding: 10px;\n    overflow: auto;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-radius: 12px;\n    margin-top: 10px;\n`)(g);const{mimeType:x,displayData:w,fileDataUrl:b}=c;let C;x.startsWith("image/")||b.startsWith("data:image/")?C=r("img",b):"image/svg+xml"===x?C=r("div",w):x.startsWith("text/")?C=r("pre",w):(C=document.createElement("div"),C.innerText="Unsupported data type for preview"),y.appendChild(C),l.append(h,f,y),s.appendChild(l),document.body.appendChild(s)})))}),!0),window.addEventListener("message",(e=>{var t;if("CLIPBOARD_CONTENTS_RESPONSE"!==(null===(t=e.data)||void 0===t?void 0:t.type))return;i("Received clipboard contents:",e.data.clipboardData),c=e.data.clipboardData;const n=document.querySelector('div[style*="position: fixed"]');if(!n)return;const o=n.querySelector("button:nth-child(2)"),a=n.querySelector("div:nth-child(3)");o.style.display="inline-block";const s=c.mimeType,l=c.displayData,d=c.fileDataUrl;let p;s.startsWith("image/")||d.startsWith("data:image/")?p=r("img",d):"image/svg+xml"===s?p=r("div",l):s.startsWith("text/")?p=r("pre",l):(p=document.createElement("div"),p.innerText="Unsupported data type for preview"),a.innerHTML="",a.appendChild(p)})),i("File input interceptor initialized")})).catch(console.error)})();