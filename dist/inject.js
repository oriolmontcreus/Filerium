(()=>{"use strict";const e=e=>`\n    background-color: ${e};\n    border: none;\n    border-radius: 12px;\n    color: white;\n    padding: 10px 20px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 16px;\n    margin: 4px 2px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n`,t="#5688C7";var n=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))};const i=console.log.bind(console),r=console.error.bind(console);i("inject.js loaded");const o=(e,t)=>{const n=document.createElement(e);return n.style.cssText="\n    max-width: 240px;\n    max-height: 230px;\n    display: none;\n",n.style.display="block","img"===e?n.src=t:n.innerHTML=t,n};n(void 0,void 0,void 0,(function*(){if(window.fileInputInterceptorActive)return i("File input interceptor already active");window.fileInputInterceptorActive=!0,i("Initializing file input interceptor");const a=yield new Promise((e=>{var n;if(!(null===(n=null===chrome||void 0===chrome?void 0:chrome.runtime)||void 0===n?void 0:n.sendMessage))return r("chrome.runtime.sendMessage is not available"),e(t);chrome.runtime.sendMessage({type:"GET_USER_COLOR"},(n=>{if(chrome.runtime.lastError)return r("Error retrieving user color:",chrome.runtime.lastError),e(t);e(n.userColor)}))}));let s=null;const l=(t,n,i)=>{const r=document.createElement("button");return r.style.cssText=e(i),r.innerHTML=t,r.onclick=n,r.onmouseover=()=>r.style.cssText+="\n    filter: brightness(0.8);\n    transform: scale(1.05);\n",r.onmouseout=()=>r.style.cssText=e(i),r},c=e=>{const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),r=new Uint8Array(i);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return new Blob([i],{type:n})},d=e=>({"image/png":"png","image/jpeg":"jpg","image/gif":"gif","text/plain":"txt","text/html":"html","text/csv":"csv","application/json":"json","image/svg+xml":"svg"}[e]||"bin");document.addEventListener("click",(e=>{if(!window.fileInputInterceptorActive)return;const t=e.target;var r,p;t instanceof HTMLInputElement&&"file"===t.type&&(e.preventDefault(),e.stopPropagation(),r=t,p=a,n(void 0,void 0,void 0,(function*(){const{success:e,clipboardData:t,message:a}=yield n(void 0,void 0,void 0,(function*(){try{const e=yield navigator.clipboard.read();i("clipboardItems:",e);for(const t of e)for(const e of t.types){const n=yield t.getType(e),i=new FileReader,r=()=>new Promise((t=>{i.onloadend=()=>t(i.result),e.startsWith("image/")?i.readAsDataURL(n):i.readAsText(n)})),o=yield r();return{success:!0,clipboardData:{fileDataUrl:e.startsWith("image/svg+xml")||"text/plain"===e&&o.startsWith("<svg")?`data:image/svg+xml;base64,${btoa(o)}`:o,mimeType:e.startsWith("image/svg+xml")||"text/plain"===e&&o.startsWith("<svg")?"image/svg+xml":e,displayData:o}}}return{success:!0,message:"No supported data found in clipboard"}}catch(e){return e("Error reading clipboard:",e),{success:!1,message:e.message}}}));if(!e||!t)return i(a||"No valid data found in clipboard, proceeding with default file input action."),window.fileInputInterceptorActive=!1,r.click(),void(window.fileInputInterceptorActive=!0);s=t;const m=document.createElement("div");m.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.5);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 9999;\n    user-select: none;\n";const u=document.createElement("div");u.style.cssText="\n    background-color: #252525;\n    padding: 20px;\n    text-align: center;\n    max-width: 80%;\n    max-height: 80%;\n    overflow: auto;\n    border-radius: 12px;\n    border: 3px solid #333;\n    color: #fff;\n",m.onclick=u.onclick=()=>m.remove();const g=l('\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle;">\n    <circle cx="17" cy="17" r="3"/>\n    <path d="M10.7 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v4.1"/>\n    <path d="m21 21-1.5-1.5"/>\n</svg>\n',(()=>{window.fileInputInterceptorActive=!1,r.click(),window.fileInputInterceptorActive=!0}),p),v=l('\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle;">\n    <path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/>\n    <path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/>\n    <path d="m17 10 4 4-4 4"/>\n</svg>\n',(()=>{const e="image/svg+xml"===s.mimeType||s.mimeType.startsWith("text/")?new Blob([s.displayData],{type:s.mimeType}):c(s.fileDataUrl),t=new File([e],`pasted_file.${d(s.mimeType)}`,{type:s.mimeType}),n=new DataTransfer;n.items.add(t),r.files=n.files,r.dispatchEvent(new Event("change",{bubbles:!0}))}),p),h=document.createElement("div");h.style.cssText="\n    max-width: 100%;\n    max-height: 230px;\n    background-color: #333;\n    color: #fff;\n    padding: 10px;\n    overflow: auto;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-radius: 12px;\n    margin-top: 10px;\n";const{mimeType:f,displayData:x,fileDataUrl:y}=s;let w;f.startsWith("image/")||y.startsWith("data:image/")?w=o("img",y):"image/svg+xml"===f?w=o("div",x):f.startsWith("text/")?w=o("pre",x):(w=document.createElement("div"),w.innerText="Unsupported data type for preview"),h.appendChild(w),u.append(g,v,h),m.appendChild(u),document.body.appendChild(m)})))}),!0),window.addEventListener("message",(e=>{var t;if("CLIPBOARD_CONTENTS_RESPONSE"!==(null===(t=e.data)||void 0===t?void 0:t.type))return;i("Received clipboard contents:",e.data.clipboardData),s=e.data.clipboardData;const n=document.querySelector('div[style*="position: fixed"]');if(!n)return;const r=n.querySelector("button:nth-child(2)"),a=n.querySelector("div:nth-child(3)");r.style.display="inline-block";const l=s.mimeType,c=s.displayData,d=s.fileDataUrl;let p;l.startsWith("image/")||d.startsWith("data:image/")?p=o("img",d):"image/svg+xml"===l?p=o("div",c):l.startsWith("text/")?p=o("pre",c):(p=document.createElement("div"),p.innerText="Unsupported data type for preview"),a.innerHTML="",a.appendChild(p)})),i("File input interceptor initialized")})).catch(console.error)})();