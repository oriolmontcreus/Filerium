(()=>{"use strict";const e="#252525",t="#333333",n="#008CBA",i=e=>`\n    background-color: ${e};\n    border: none;\n    border-radius: 12px;\n    color: white;\n    padding: 10px 20px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 16px;\n    margin: 4px 2px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n`;var o=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{s(i.next(e))}catch(e){r(e)}}function l(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((i=i.apply(e,t||[])).next())}))};const r=console.log.bind(console),a=console.error.bind(console);r("inject.js loaded");const l=(e,t)=>{const n=document.createElement(e);return n.style.cssText="\n    width: 100%;\n    height: auto;\n    max-width: 70%;\n    max-height: 55vh;\n    display: block;\n    margin: auto;\n    object-fit: contain;\n","img"===e?(n.src=t,n.style.maxWidth="100%",n.style.height="auto"):n.innerHTML=t,n};o(void 0,void 0,void 0,(function*(){if(window.fileInputInterceptorActive)return r("File input interceptor already active");window.fileInputInterceptorActive=!0,r("Initializing file input interceptor");const{primaryColor:s,secondaryColor:c,actionColor:d}=yield new Promise((i=>{var o;if(!(null===(o=null===chrome||void 0===chrome?void 0:chrome.runtime)||void 0===o?void 0:o.sendMessage))return a("chrome.runtime.sendMessage is not available"),i({primaryColor:e,secondaryColor:n,actionColor:t});chrome.runtime.sendMessage({type:"GET_USER_COLORS"},(o=>{if(chrome.runtime.lastError)return a("Error retrieving user colors:",chrome.runtime.lastError),i({primaryColor:e,secondaryColor:t,actionColor:n});i({primaryColor:o.primaryColor,secondaryColor:o.secondaryColor,actionColor:o.actionColor})}))}));let p=null;const m=(e,t,n)=>{const o=document.createElement("button");return o.style.cssText=i(n),o.innerHTML=e,o.onclick=t,o.onmouseover=()=>o.style.cssText+="\n    filter: brightness(0.8);\n    transform: scale(1.05);\n",o.onmouseout=()=>o.style.cssText=i(n),o},u=e=>{const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),o=new Uint8Array(i);for(let e=0;e<t.length;e++)o[e]=t.charCodeAt(e);return new Blob([i],{type:n})},g=e=>({"image/png":"png","image/jpeg":"jpg","image/gif":"gif","text/plain":"txt","text/html":"html","text/csv":"csv","application/json":"json","image/svg+xml":"svg"}[e]||"bin");document.addEventListener("click",(e=>{if(!window.fileInputInterceptorActive)return;const t=e.target;var n,i,a,v;t instanceof HTMLInputElement&&"file"===t.type&&(e.preventDefault(),e.stopPropagation(),n=t,i=s,a=c,v=d,o(void 0,void 0,void 0,(function*(){const{success:e,clipboardData:t,message:s}=yield o(void 0,void 0,void 0,(function*(){try{const e=yield navigator.clipboard.read();r("clipboardItems:",e);for(const t of e)for(const e of t.types){const n=yield t.getType(e),i=new FileReader,o=()=>new Promise((t=>{i.onloadend=()=>t(i.result),e.startsWith("image/")?i.readAsDataURL(n):i.readAsText(n)})),r=yield o();return{success:!0,clipboardData:{fileDataUrl:e.startsWith("image/svg+xml")||"text/plain"===e&&r.startsWith("<svg")?`data:image/svg+xml;base64,${btoa(r)}`:r,mimeType:e.startsWith("image/svg+xml")||"text/plain"===e&&r.startsWith("<svg")?"image/svg+xml":e,displayData:r}}}return{success:!0,message:"No supported data found in clipboard"}}catch(e){return e("Error reading clipboard:",e),{success:!1,message:e.message}}}));if(!e||!t)return r(s||"No valid data found in clipboard, proceeding with default file input action."),window.fileInputInterceptorActive=!1,n.click(),void(window.fileInputInterceptorActive=!0);p=t;const c=document.createElement("div");c.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.5);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 9999;\n    user-select: none;\n";const d=document.createElement("div");d.style.cssText=(e=>`\n    background-color: ${e};\n    padding: 20px;\n    text-align: center;\n    max-width: 80%;\n    max-height: 80%;\n    overflow: auto;\n    border-radius: 12px;\n    border: 3px solid #333;\n    color: #fff;\n`)(i),d.onclick=e=>e.stopPropagation(),c.onclick=()=>c.remove();const h=document.createElement("div");h.style.display="flex",h.style.gap="8px";const f=document.createElement("div");f.style.display="flex",f.style.justifyContent="space-between",f.style.flexWrap="wrap",f.style.alignItems="center",f.style.gap="8px";const y=m('\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle;">\n    <circle cx="17" cy="17" r="3"/>\n    <path d="M10.7 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v4.1"/>\n    <path d="m21 21-1.5-1.5"/>\n</svg>\n',(()=>{window.fileInputInterceptorActive=!1,n.click(),window.fileInputInterceptorActive=!0,n.addEventListener("change",(()=>c.remove()),{once:!0})}),v),x=m('\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle;">\n    <path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/>\n    <path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/>\n    <path d="m17 10 4 4-4 4"/>\n</svg>\n',(()=>{var e;let t=p.mimeType;p.fileDataUrl.startsWith("data:image/")&&(t=(null===(e=p.fileDataUrl.match(/data:([^;,]+)/))||void 0===e?void 0:e[1])||t);const i="image/svg+xml"===t||t.startsWith("text/")?new Blob([p.displayData],{type:t}):u(p.fileDataUrl),o=`pasted_file.${g(t)}`,r=T.value.trim()?`${T.value.trim()}.${g(t)}`:o,a=new File([i],r,{type:t}),l=new DataTransfer;l.items.add(a),n.files=l.files,n.dispatchEvent(new Event("change",{bubbles:!0})),c.remove()}),v),w=document.createElement("div");w.style.cssText=(e=>`\n    max-width: 100%;\n    max-height: 90vh;\n    background-color: ${e};\n    color: #fff;\n    padding: 10px;\n    overflow: auto;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-radius: 12px;\n    margin-top: 10px;\n`)(a);const{mimeType:b,displayData:C,fileDataUrl:E}=p;let k;b.startsWith("image/")||E.startsWith("data:image/")?k=l("img",E):"image/svg+xml"===b?k=l("div",C):b.startsWith("text/")?k=l("pre",C):(k=document.createElement("div"),k.innerText="Unsupported data type for preview");const T=document.createElement("input");T.type="text",T.style.cssText=((e,t)=>`\n    display: inline-block;\n    border-radius: 10px;\n    outline: 2px solid ${t};\n    border: 0;\n    color: #fff;\n    background-color: ${e};\n    outline-offset: 3px;\n    padding: 10px 1rem;\n    transition: 0.25s;\n`)(a,i),T.placeholder="Enter filename (optional)",T.onclick=e=>e.stopPropagation(),h.append(y,x),f.append(h,T),w.appendChild(k),d.append(f,w),c.appendChild(d),document.body.appendChild(c)})))}),!0),window.addEventListener("message",(e=>{var t;if("CLIPBOARD_CONTENTS_RESPONSE"!==(null===(t=e.data)||void 0===t?void 0:t.type))return;r("Received clipboard contents:",e.data.clipboardData),p=e.data.clipboardData;const n=document.querySelector('div[style*="position: fixed"]');if(!n)return;const i=n.querySelector("button:nth-child(2)"),o=n.querySelector("div:nth-child(2) > div:nth-child(2)");i.style.display="inline-block";const a=p.mimeType,s=p.displayData,c=p.fileDataUrl;let d;a.startsWith("image/")||c.startsWith("data:image/")?d=l("img",c):"image/svg+xml"===a?d=l("div",s):a.startsWith("text/")?d=l("pre",s):(d=document.createElement("div"),d.innerText="Unsupported data type for preview"),o.innerHTML="",o.appendChild(d)})),r("File input interceptor initialized")})).catch(console.error)})();